---
type Lang = "en" | "pt";
type LinkTuple = readonly [label: string, path: string];

// ✅ SAME AS HEADER: get lang from props (reliable)
const { lang = "en" } = Astro.props;
const isPT = String(lang).startsWith("pt");

// ✅ GitHub Pages base path
const basePath = import.meta.env.BASE_URL?.replace(/\/$/, "") || "";
const href = (path: string) => `${basePath}${path}`;

// Language routes
const homeHref = href(isPT ? "/pt/" : "/en/");

// Legal
const termsHref = href(isPT ? "/pt/terms" : "/en/terms");
const privacyHref = href(isPT ? "/pt/privacy" : "/en/privacy");

// Footer links
const shopLinks: readonly LinkTuple[] = isPT
  ? [
      ["Loja", "/pt/shop"],
      ["Tábuas de Cortar", "/pt/shop/chopping-boards"],
      ["Tábuas End-Grain", "/pt/shop/end-grain-boards"],
      ["Tábuas de Servir", "/pt/shop/serving-boards"],
      ["Carrinho", "/pt/cart"],
    ]
  : [
      ["Shop Home", "/en/shop"],
      ["Chopping Boards", "/en/shop/chopping-boards"],
      ["End-Grain Boards", "/en/shop/end-grain-boards"],
      ["Serving Boards", "/en/shop/serving-boards"],
      ["Your Cart", "/en/cart"],
    ];

const bespokeLinks: readonly LinkTuple[] = isPT
  ? [
      ["Carpintaria por Medida", "/pt/bespoke"],
      ["Como Funciona", "/pt/bespoke#process"],
      ["Materiais", "/pt/bespoke#materials"],
      ["Perguntas Frequentes", "/pt/bespoke#faq"],
    ]
  : [
      ["Bespoke Page", "/en/bespoke"],
      ["How It Works", "/en/bespoke#process"],
      ["Materials", "/en/bespoke#materials"],
      ["Bespoke FAQ", "/en/bespoke#faq"],
    ];

const quoteHref = href(isPT ? "/pt/contact" : "/en/contact");

const copy = isPT
  ? {
      brand: "Samsara",
      tagline:
        "Tábuas de cortar artesanais, tábuas de servir, blocos end-grain e carpintaria por medida — feitos com madeiras de origem responsável.",
      shopTitle: "Loja",
      bespokeTitle: "Por Medida",
      contactTitle: "Contacto",
      madeIn: "Feito em Portugal",
      quote: "Pedir Orçamento",
      rights: "Todos os direitos reservados.",
      privacy: "Privacidade",
      terms: "Termos",
      instagramLabel: "Instagram",
    }
  : {
      brand: "Samsara",
      tagline:
        "Handcrafted chopping boards, serving boards, end-grain butcher blocks, and bespoke carpentry — made from sustainably sourced hardwoods.",
      shopTitle: "Shop",
      bespokeTitle: "Bespoke",
      contactTitle: "Contact",
      madeIn: "Made in Portugal",
      quote: "Request a Quote",
      rights: "All rights reserved.",
      privacy: "Privacy",
      terms: "Terms",
      instagramLabel: "Instagram",
    };

const emailLabel = "samsara@samsara.pt";
const emailHref = "mailto:samsara@samsara.pt";
const phoneLabel = "+351 915 639 435";
const phoneHref = "tel:+351915639435";
const instagramHref = "https://www.instagram.com/samsara_carpentrystudios/";
---

<footer class="site-footer" role="contentinfo">
  <div class="page-container footer-grid">
    <div class="footer-brand">
      <a class="footer-logo" href={homeHref} aria-label="Samsara home">
        {copy.brand}
      </a>
      <p class="footer-tagline">{copy.tagline}</p>
    </div>

    <nav class="footer-col" aria-label={`${copy.shopTitle} navigation`}>
      <h2 class="footer-title">{copy.shopTitle}</h2>
      <ul class="footer-links">
        {shopLinks.map(([label, path]) => (
          <li><a href={href(path)}>{label}</a></li>
        ))}
      </ul>
    </nav>

    <nav class="footer-col" aria-label={`${copy.bespokeTitle} navigation`}>
      <h2 class="footer-title">{copy.bespokeTitle}</h2>
      <ul class="footer-links">
        {bespokeLinks.map(([label, path]) => (
          <li><a href={href(path)}>{label}</a></li>
        ))}
      </ul>
    </nav>

    <div class="footer-col footer-contact">
      <h2 class="footer-title">{copy.contactTitle}</h2>

      <address>
        <span>{copy.madeIn}</span><br />
        <a href={emailHref}>{emailLabel}</a><br />
        <a href={phoneHref}>{phoneLabel}</a>
      </address>

      <a class="footer-btn" href={quoteHref}>{copy.quote}</a>

      <div class="footer-social">
        <a href={instagramHref} target="_blank" rel="noopener">
          {copy.instagramLabel}
        </a>
      </div>
    </div>

    <div class="footer-legal">
      <p>© {new Date().getFullYear()} Samsara. {copy.rights}</p>
      <div class="footer-legal-links">
        <a href={privacyHref}>{copy.privacy}</a>
        <span aria-hidden="true"> · </span>
        <a href={termsHref}>{copy.terms}</a>
      </div>
    </div>
  </div>
</footer>